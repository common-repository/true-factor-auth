!function(u){window.replaceMobileInput||(window.replaceMobileInput=function(e){var t={nationalMode:!1,autoHideDialCode:!1,autoPlaceholder:"aggressive",formatOnDisplay:!0,preferredCountries:[]};return tfa_main.preferred_country&&(t.preferredCountries=[tfa_main.preferred_country]),tfa_main.countries&&(t.onlyCountries=tfa_main.countries),intlTelInput(e,t)}),window.tfaInitSmsConfirmationForm||(window.tfaInitSmsConfirmationForm=function(e){var t=e.find(".tfa-confirm-sms");if(t.length){var r=t.data("timeout"),n=t.find("[name=tel]:visible");n.length&&replaceMobileInput(n[0]);var a=t.find("[name=code]");if(!a.length)throw Error("No code input.");var s=t.find(".tfa-send-sms-button");if(!s.length){(s=u('<button type="button" class="button tfa-send-sms-button"></button>')).text(tfa_sms.t_send_sms||"Send SMS");var o=t.find("[type=submit]").first();s.insertBefore(o)}var i,d,f=parseInt(tfa_sms.resend_timer,10)||120,m=function(){0<--i?s.text(tfa_sms.t_resend_sms+" ("+i+")"):(n.removeAttr("readonly"),s.text(tfa_sms.t_resend_sms),s.removeProp("disabled"),clearInterval(d))},l=function(){d=setInterval(m,1e3)};r&&(n.attr("readonly","readonly"),s.prop("disabled",!0),i=parseInt(r,10),m(),l()),s.on("click",function(){u.ajax({url:tfa_main.ajax_url+"?action=tfa_send_sms",method:"POST",dataType:"json",data:t.serialize(),success:function(e){e.timeout&&(i=e.timeout),(e.error||e.error_message)&&(tfaShowError(e.error||e.error_message,"error"),s.removeProp("disabled"),s.text(tfa_sms.t_resend_sms),n.removeAttr("readonly")),e.message&&tfaShowMessage(e.message),e.success&&(i=f+1,m(),l()),a.focus()},fail:function(){s.removeProp("disabled"),s.text(tfa_sms.t_resend_sms),n.removeAttr("readonly")}}),n.attr("readonly","readonly"),s.text(tfa_sms.t_sending),s.prop("disabled",!0)})}}),window.tfaInitCallbacks||(window.tfaInitCallbacks=[]),window.tfaInitCallbacks.push(tfaInitSmsConfirmationForm)}(jQuery);